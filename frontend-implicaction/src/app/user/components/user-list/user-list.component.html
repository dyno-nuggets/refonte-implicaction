<div class="row">
  <div class="col-2 list-group">
    <a
      class="list-group-item list-group-item-action"
      routerLink="/users/list"
      routerLinkActive="active"
    >
      Tous les utilisateurs
    </a>
    <a
      [routerLinkActiveOptions]="{exact: true}"
      class="list-group-item list-group-item-action"
      routerLink="/users/friends"
      routerLinkActive="active"
    >
      Mes amis
    </a>
    <a
      [routerLinkActiveOptions]="{exact: true}"
      class="list-group-item list-group-item-action"
      routerLink="/users/friends/received"
      routerLinkActive="active"
    >
      Demandes reçues
    </a>
    <a
      [routerLinkActiveOptions]="{exact: true}"
      class="list-group-item list-group-item-action"
      routerLink="/users/friends/sent"
      routerLinkActive="active"
    >
      Demandes envoyées
    </a>
  </div>
  <div class="col-9 ms-5">
    <div class="row row-cols-xs-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-6 mb-2">
      <ng-container *ngFor="let user of users">
        <app-user-card [user]="user">
          <div class="mt-4 mb-2">
            <!-- CAS 1 : est un ami -->
            <ng-container *ngIf="isFriend(user); else optionSender">
              <button
                (click)="removeUserFromFriends(user)"
                class="btn btn-danger text-light rounded-pill"
                data-bs-placement="top"
                data-bs-toggle="tooltip"
                title="Retirer des amis"
                type="button"
              >
                <i-feather class="icon" name="user-minus"></i-feather>
              </button>
            </ng-container>
            <!-- CAS 2 : est à l'origine d'une demande non acceptée -->
            <ng-template #optionSender>
              <ng-container *ngIf="isSender(user); else optionReceiver">
                <button
                  class="btn btn-danger text-light rounded-pill"
                  data-bs-placement="top"
                  data-bs-toggle="tooltip"
                  title="Annuler la demande d'ami"
                  type="button"
                >
                  <i-feather class="icon" name="user-x"></i-feather>
                </button>
              </ng-container>
            </ng-template>
            <!-- CAS 3 : est receveur d'une demande non acceptée -->
            <ng-template #optionReceiver>
              <ng-container *ngIf="isReceiver(user); else optionNoRelation">
                <button
                  (click)="confirmUserAsFriend(user)"
                  class="btn btn-success rounded-pill mx-2 mx-sm-1"
                  data-bs-placement="top"
                  data-bs-toggle="tooltip"
                  title="Accepter la demande d'ami"
                  type="button"
                >
                  <i-feather class="icon" name="user-check"></i-feather>
                </button>
                <button
                  class="btn btn-danger rounded-pill mx-2 mx-sm-1"
                  data-bs-placement="top"
                  data-bs-toggle="tooltip"
                  title="Annuler la demande d'ami"
                  type="button"
                >
                  <i-feather class="icon" name="user-x"></i-feather>
                </button>
              </ng-container>
            </ng-template>
            <!-- CAS 4 : aucune relation -->
            <ng-template #optionNoRelation>
              <button
                (click)="requestUserAsFriend(user)"
                class="btn btn-primary rounded-pill"
                data-bs-placement="top"
                data-bs-toggle="tooltip"
                title="Demander en ami"
                type="button"
              >
                <i-feather class="icon" name="user-plus"></i-feather>
              </button>
            </ng-template>
          </div>
        </app-user-card>
      </ng-container>
    </div>
    <p-paginator
      (onPageChange)="paginate($event)"
      *ngIf="pageable.totalPages > 1"
      [rowsPerPageOptions]="[10, 25, 50]"
      [rows]="rowsPerPage"
      [totalRecords]="pageable.totalElements"
    >
    </p-paginator>
  </div>
</div>
